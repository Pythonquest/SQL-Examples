CREATE OR REPLACE FUNCTION IDC_GET_PO_HDR_BUY_ORG_ID(
                         pv_PO_ID		VARCHAR2, 
                         pi_PO_RLSE_NO	NUMBER
                         )
                         
RETURN VARCHAR2

IS
    lv_ORG_ID_RESULT    VARCHAR2(20);
    lv_EMPL_ID_RESULT   VARCHAR2(12);
    lv_BUYER_ID_RESULT  VARCHAR2(12);
    
	BEGIN
			
		-- FIRST PREFERENCE: WALK FROM PO_HDR TO BUYER TO EMPL_LAB_INFO TO OBTAIN ORG_ID
		SELECT BUYER_ID INTO lv_BUYER_ID_RESULT FROM DELTEK.PO_HDR          WHERE PO_ID = pv_PO_ID AND PO_RLSE_NO = pi_PO_RLSE_NO;
		SELECT EMPL_ID  INTO lv_EMPL_ID_RESULT  FROM DELTEK.BUYER           WHERE BUYER_ID = lv_BUYER_ID_RESULT;
		SELECT ORG_ID   INTO lv_ORG_ID_RESULT   FROM DELTEK.EMPL_LAB_INFO   WHERE ROWNUM = 1 AND EMPL_ID = lv_EMPL_ID_RESULT;
										
		-- ALTERNATE RESULT: IF PREVIOUS SEARCH YIELDS NULL, THEN OBTAIN ORG_ID FROM PO_HDR_DFLT
		IF lv_ORG_ID_RESULT IS NULL THEN
			SELECT ORG_ID INTO lv_ORG_ID_RESULT FROM DELTEK.PO_HDR_DFLT 
										WHERE PO_ID = pv_PO_ID AND PO_RLSE_NO = pi_PO_RLSE_NO;
		END IF;
										
		RETURN lv_ORG_ID_RESULT;
					
	END;